{"ast":null,"code":"/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getGlobalObject } from '@sentry/utils';\nimport { onHidden } from './onHidden';\nvar firstHiddenTime = -1;\nvar initHiddenTime = function () {\n  return getGlobalObject().document.visibilityState === 'hidden' ? 0 : Infinity;\n};\nvar trackChanges = function () {\n  // Update the time if/when the document becomes hidden.\n  onHidden(function (_a) {\n    var timeStamp = _a.timeStamp;\n    firstHiddenTime = timeStamp;\n  }, true);\n};\nexport var getVisibilityWatcher = function () {\n  if (firstHiddenTime < 0) {\n    // If the document is hidden when this code runs, assume it was hidden\n    // since navigation start. This isn't a perfect heuristic, but it's the\n    // best we can do until an API is available to support querying past\n    // visibilityState.\n    firstHiddenTime = initHiddenTime();\n    trackChanges();\n  }\n  return {\n    get firstHiddenTime() {\n      return firstHiddenTime;\n    }\n  };\n};","map":{"version":3,"names":["getGlobalObject","onHidden","firstHiddenTime","initHiddenTime","document","visibilityState","Infinity","trackChanges","_a","timeStamp","getVisibilityWatcher"],"sources":["../../../../../../src/browser/web-vitals/lib/getVisibilityWatcher.ts"],"sourcesContent":["/*\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalObject } from '@sentry/utils';\n\nimport { onHidden } from './onHidden';\n\nlet firstHiddenTime = -1;\n\nconst initHiddenTime = (): number => {\n  return getGlobalObject<Window>().document.visibilityState === 'hidden' ? 0 : Infinity;\n};\n\nconst trackChanges = (): void => {\n  // Update the time if/when the document becomes hidden.\n  onHidden(({ timeStamp }) => {\n    firstHiddenTime = timeStamp;\n  }, true);\n};\n\nexport const getVisibilityWatcher = (): {\n  readonly firstHiddenTime: number;\n} => {\n  if (firstHiddenTime < 0) {\n    // If the document is hidden when this code runs, assume it was hidden\n    // since navigation start. This isn't a perfect heuristic, but it's the\n    // best we can do until an API is available to support querying past\n    // visibilityState.\n    firstHiddenTime = initHiddenTime();\n    trackChanges();\n  }\n  return {\n    get firstHiddenTime() {\n      return firstHiddenTime;\n    },\n  };\n};\n"],"mappings":"AAAA;;;;;;;;;;;;;;;AAgBA,SAASA,eAAe,QAAQ,eAAe;AAE/C,SAASC,QAAQ,QAAQ,YAAY;AAErC,IAAIC,eAAe,GAAG,CAAC,CAAC;AAExB,IAAMC,cAAc,GAAG,SAAAA,CAAA;EACrB,OAAOH,eAAe,EAAU,CAACI,QAAQ,CAACC,eAAe,KAAK,QAAQ,GAAG,CAAC,GAAGC,QAAQ;AACvF,CAAC;AAED,IAAMC,YAAY,GAAG,SAAAA,CAAA;EACnB;EACAN,QAAQ,CAAC,UAACO,EAAa;QAAXC,SAAA,GAAAD,EAAA,CAAAC,SAAS;IACnBP,eAAe,GAAGO,SAAS;EAC7B,CAAC,EAAE,IAAI,CAAC;AACV,CAAC;AAED,OAAO,IAAMC,oBAAoB,GAAG,SAAAA,CAAA;EAGlC,IAAIR,eAAe,GAAG,CAAC,EAAE;IACvB;IACA;IACA;IACA;IACAA,eAAe,GAAGC,cAAc,EAAE;IAClCI,YAAY,EAAE;;EAEhB,OAAO;IACL,IAAIL,eAAeA,CAAA;MACjB,OAAOA,eAAe;IACxB;GACD;AACH,CAAC"},"metadata":{},"sourceType":"module"}