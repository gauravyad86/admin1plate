{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/gauravyadav/Downloads/food-delivery-multivendor-main/enatega-multivendor-admin/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject;import React,{useEffect,useState}from'react';import{getToken,onMessage}from'firebase/messaging';import GoogleMapsLoader from'./components/GoogleMapsLoader/GoogleMapsLoader.js';import{Box,CircularProgress}from'@mui/material';import AdminLayout from'./layouts/Admin.jsx';import RestaurantLayout from'./layouts/Restaurant.jsx';import AuthLayout from'./layouts/Auth.jsx';import SuperAdminLayout from'./layouts/SuperAdmin.jsx';import{PrivateRoute}from'./views/PrivateRoute';import{AdminPrivateRoute}from'./views/AdminPrivateRoute';import{HashRouter,Route,Switch,Redirect}from'react-router-dom';import*as Sentry from'@sentry/react';import{isFirebaseSupported,initialize}from'./firebase.js';import{uploadToken}from'./apollo';import{gql,useApolloClient}from'@apollo/client';import ConfigurableValues from'./config/constants.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";require('./i18n');const UPLOAD_TOKEN=gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  \",\"\\n\"])),uploadToken);const App=()=>{const{VAPID_KEY,FIREBASE_KEY,AUTH_DOMAIN,PROJECT_ID,STORAGE_BUCKET,MSG_SENDER_ID,APP_ID,MEASUREMENT_ID,GOOGLE_MAPS_KEY}=ConfigurableValues();console.log('GOOGLE_MAPS_KEY_App',GOOGLE_MAPS_KEY);// const [mapsKey, setMapsKey] = useState(null)\n// useEffect(() => {\n//   if (GOOGLE_MAPS_KEY) {\n//     setMapsKey(GOOGLE_MAPS_KEY)\n//   }\n// }, [GOOGLE_MAPS_KEY])\nconst client=useApolloClient();const[user]=useState(localStorage.getItem('user-enatega'));const userType=localStorage.getItem('user-enatega')?JSON.parse(localStorage.getItem('user-enatega')).userType:null;useEffect(()=>{if(user){const initializeFirebase=async()=>{if(await isFirebaseSupported()){const messaging=initialize(FIREBASE_KEY,AUTH_DOMAIN,PROJECT_ID,STORAGE_BUCKET,MSG_SENDER_ID,APP_ID,MEASUREMENT_ID);Notification.requestPermission().then(()=>{getToken(messaging,{vapidKey:VAPID_KEY}).then(token=>{localStorage.setItem('messaging-token',token);client.mutate({mutation:UPLOAD_TOKEN,variables:{id:JSON.parse(user).userId,pushToken:token}}).then(()=>{console.log('upload token success');}).catch(error=>{console.log('upload token error',error);});}).catch(err=>{console.log('getToken error',err);});}).catch(console.log);onMessage(messaging,function(payload){console.log(payload);// Customize notification here\n// const { title, body } = payload.notification\n// eslint-disable-next-line no-restricted-globals\nvar notificationTitle='New Order on Enatega Multivendor';var notificationOptions={body:payload.data.orderid,icon:'https://multivendor-admin.ninjascode.com/favicon.png'};const nt=new Notification(notificationTitle,notificationOptions);nt.onclick=function(event){event.preventDefault();// prevent the browser from focusing the Notification's tab\nwindow.open('https://multivendor-admin.ninjascode.com/dashboard');nt.close();};});}};initializeFirebase();}},[user]);const route=userType?userType==='VENDOR'?'/restaurant/list':'/super_admin/vendors':'/auth/login';return/*#__PURE__*/_jsx(Sentry.ErrorBoundary,{children:GOOGLE_MAPS_KEY?/*#__PURE__*/_jsx(GoogleMapsLoader,{GOOGLE_MAPS_KEY:GOOGLE_MAPS_KEY,children:/*#__PURE__*/_jsx(HashRouter,{basename:\"/\",children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(AdminPrivateRoute,{path:\"/super_admin\",component:props=>/*#__PURE__*/_jsx(SuperAdminLayout,{...props})}),/*#__PURE__*/_jsx(PrivateRoute,{path:\"/restaurant\",component:props=>/*#__PURE__*/_jsx(RestaurantLayout,{...props})}),/*#__PURE__*/_jsx(PrivateRoute,{path:\"/admin\",component:props=>/*#__PURE__*/_jsx(AdminLayout,{...props})}),/*#__PURE__*/_jsx(Route,{path:\"/auth\",component:props=>/*#__PURE__*/_jsx(AuthLayout,{...props})}),/*#__PURE__*/_jsx(Redirect,{from:\"/\",to:route})]})})}):/*#__PURE__*/_jsx(Box,{component:\"div\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",height:\"100vh\",width:\"100vw\",children:/*#__PURE__*/_jsx(CircularProgress,{color:\"primary\"})})});};export default Sentry.withProfiler(App);","map":{"version":3,"names":["React","useEffect","useState","getToken","onMessage","GoogleMapsLoader","Box","CircularProgress","AdminLayout","RestaurantLayout","AuthLayout","SuperAdminLayout","PrivateRoute","AdminPrivateRoute","HashRouter","Route","Switch","Redirect","Sentry","isFirebaseSupported","initialize","uploadToken","gql","useApolloClient","ConfigurableValues","jsx","_jsx","jsxs","_jsxs","require","UPLOAD_TOKEN","_templateObject","_taggedTemplateLiteral","App","VAPID_KEY","FIREBASE_KEY","AUTH_DOMAIN","PROJECT_ID","STORAGE_BUCKET","MSG_SENDER_ID","APP_ID","MEASUREMENT_ID","GOOGLE_MAPS_KEY","console","log","client","user","localStorage","getItem","userType","JSON","parse","initializeFirebase","messaging","Notification","requestPermission","then","vapidKey","token","setItem","mutate","mutation","variables","id","userId","pushToken","catch","error","err","payload","notificationTitle","notificationOptions","body","data","orderid","icon","nt","onclick","event","preventDefault","window","open","close","route","ErrorBoundary","children","basename","path","component","props","from","to","display","alignItems","justifyContent","height","width","color","withProfiler"],"sources":["/Users/gauravyadav/Downloads/food-delivery-multivendor-main/enatega-multivendor-admin/src/app.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { getToken, onMessage } from 'firebase/messaging'\nimport GoogleMapsLoader from './components/GoogleMapsLoader/GoogleMapsLoader.js'\nimport { Box, CircularProgress } from '@mui/material'\nimport AdminLayout from './layouts/Admin.jsx'\nimport RestaurantLayout from './layouts/Restaurant.jsx'\nimport AuthLayout from './layouts/Auth.jsx'\nimport SuperAdminLayout from './layouts/SuperAdmin.jsx'\nimport { PrivateRoute } from './views/PrivateRoute'\nimport { AdminPrivateRoute } from './views/AdminPrivateRoute'\nimport { HashRouter, Route, Switch, Redirect } from 'react-router-dom'\nimport * as Sentry from '@sentry/react'\nimport { isFirebaseSupported, initialize } from './firebase.js'\nimport { uploadToken } from './apollo'\nimport { gql, useApolloClient } from '@apollo/client'\nimport ConfigurableValues from './config/constants.js'\n\nrequire('./i18n')\n\nconst UPLOAD_TOKEN = gql`\n  ${uploadToken}\n`\n\nconst App = () => {\n  const {\n    VAPID_KEY,\n    FIREBASE_KEY,\n    AUTH_DOMAIN,\n    PROJECT_ID,\n    STORAGE_BUCKET,\n    MSG_SENDER_ID,\n    APP_ID,\n    MEASUREMENT_ID,\n    GOOGLE_MAPS_KEY\n  } = ConfigurableValues()\n  console.log('GOOGLE_MAPS_KEY_App', GOOGLE_MAPS_KEY)\n  // const [mapsKey, setMapsKey] = useState(null)\n  // useEffect(() => {\n  //   if (GOOGLE_MAPS_KEY) {\n  //     setMapsKey(GOOGLE_MAPS_KEY)\n  //   }\n  // }, [GOOGLE_MAPS_KEY])\n  const client = useApolloClient()\n  const [user] = useState(localStorage.getItem('user-enatega'))\n  const userType = localStorage.getItem('user-enatega')\n    ? JSON.parse(localStorage.getItem('user-enatega')).userType\n    : null\n  useEffect(() => {\n    if (user) {\n      const initializeFirebase = async() => {\n        if (await isFirebaseSupported()) {\n          const messaging = initialize(\n            FIREBASE_KEY,\n            AUTH_DOMAIN,\n            PROJECT_ID,\n            STORAGE_BUCKET,\n            MSG_SENDER_ID,\n            APP_ID,\n            MEASUREMENT_ID\n          )\n          Notification.requestPermission()\n            .then(() => {\n              getToken(messaging, {\n                vapidKey: VAPID_KEY\n              })\n                .then(token => {\n                  localStorage.setItem('messaging-token', token)\n                  client\n                    .mutate({\n                      mutation: UPLOAD_TOKEN,\n                      variables: {\n                        id: JSON.parse(user).userId,\n                        pushToken: token\n                      }\n                    })\n                    .then(() => {\n                      console.log('upload token success')\n                    })\n                    .catch(error => {\n                      console.log('upload token error', error)\n                    })\n                })\n                .catch(err => {\n                  console.log('getToken error', err)\n                })\n            })\n            .catch(console.log)\n\n          onMessage(messaging, function(payload) {\n            console.log(payload)\n            // Customize notification here\n            // const { title, body } = payload.notification\n            // eslint-disable-next-line no-restricted-globals\n            var notificationTitle = 'New Order on Enatega Multivendor'\n            var notificationOptions = {\n              body: payload.data.orderid,\n              icon: 'https://multivendor-admin.ninjascode.com/favicon.png'\n            }\n            const nt = new Notification(notificationTitle, notificationOptions)\n            nt.onclick = function(event) {\n              event.preventDefault() // prevent the browser from focusing the Notification's tab\n              window.open('https://multivendor-admin.ninjascode.com/dashboard')\n              nt.close()\n            }\n          })\n        }\n      }\n      initializeFirebase()\n    }\n  }, [user])\n  const route = userType\n    ? userType === 'VENDOR'\n      ? '/restaurant/list'\n      : '/super_admin/vendors'\n    : '/auth/login'\n  return (\n    <Sentry.ErrorBoundary>\n      {GOOGLE_MAPS_KEY ? (\n        <GoogleMapsLoader GOOGLE_MAPS_KEY={GOOGLE_MAPS_KEY}>\n          <HashRouter basename=\"/\">\n            <Switch>\n              <AdminPrivateRoute\n                path=\"/super_admin\"\n                component={props => <SuperAdminLayout {...props} />}\n              />\n              <PrivateRoute\n                path=\"/restaurant\"\n                component={props => <RestaurantLayout {...props} />}\n              />\n              <PrivateRoute\n                path=\"/admin\"\n                component={props => <AdminLayout {...props} />}\n              />\n              <Route\n                path=\"/auth\"\n                component={props => <AuthLayout {...props} />}\n              />\n              <Redirect from=\"/\" to={route} />\n            </Switch>\n          </HashRouter>\n        </GoogleMapsLoader>\n      ) : (\n        <Box\n          component=\"div\"\n          display=\"flex\"\n          alignItems=\"center\"\n          justifyContent=\"center\"\n          height=\"100vh\"\n          width=\"100vw\">\n          <CircularProgress color=\"primary\" />\n        </Box>\n      )}\n    </Sentry.ErrorBoundary>\n  )\n}\nexport default Sentry.withProfiler(App)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}